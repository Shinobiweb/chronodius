<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Uchronie des véhicules • Starter 1925–2125</title>
  <style>
    :root {
      --bg: #0b1020;
      --fg: #e6e9f5;
      --muted: #aab0c4;
      --panel: #121833;
      --accent: #86e1ff;
      --btn: #1a224a;
      --btn-fg: #dbe6ff;
      --ring: #86e1ff66;
    }
    .theme-light{ --bg:#f5f7fb; --fg:#101223; --muted:#5b6177; --panel:#ffffff; --accent:#2b79ff; --btn:#e8ecf9; --btn-fg:#0f1a3a; --ring:#2b79ff55; }
    .theme-dark { --bg:#0b1020; --fg:#e6e9f5; --muted:#aab0c4; --panel:#121833; --accent:#86e1ff; --btn:#1a224a; --btn-fg:#dbe6ff; --ring:#86e1ff66; }
    .theme-night{ --bg:#04050b; --fg:#d6d9eb; --muted:#9aa2c0; --panel:#0a0f24; --accent:#9a7bff; --btn:#10183a; --btn-fg:#e6e6ff; --ring:#9a7bff55; }

    html,body{height:100%;}
    body{
      margin:0; background:var(--bg); color:var(--fg); font-family: system-ui, -apple-system, Segoe UI, Roboto, Inter, Helvetica, Arial, sans-serif;
      line-height:1.45; letter-spacing:.2px;
    }
    header{
      position:sticky; top:0; z-index:10; backdrop-filter:saturate(140%) blur(8px);
      background: linear-gradient(180deg, color-mix(in oklab, var(--bg), #000 20%) 0%, var(--bg) 100%);
      border-bottom:1px solid color-mix(in oklab, var(--panel), #000 35%);
    }
    .wrap{ max-width:1100px; margin:0 auto; padding:16px; }
    h1{ font-size: clamp(20px, 2.3vw, 32px); margin:0; }
    .sub{ color:var(--muted); font-size:14px; }

    .bar{ display:flex; gap:10px; flex-wrap:wrap; align-items:center; margin-top:12px; }
    .eras, .themes{ display:flex; gap:8px; flex-wrap:wrap; }
    button{
      appearance:none; border:1px solid transparent; background:var(--btn); color:var(--btn-fg);
      padding:8px 12px; border-radius:999px; font-weight:600; cursor:pointer; transition: .15s ease;
    }
    button:hover{ transform:translateY(-1px); box-shadow:0 6px 16px -8px var(--ring); }
    button:focus{ outline:2px solid transparent; box-shadow:0 0 0 3px var(--ring); }
    button[aria-current="true"]{ border-color:var(--accent); box-shadow:0 0 0 3px var(--ring) inset; }
    button[disabled]{ opacity:.45; cursor:not-allowed; }

    main{ padding:24px 0 64px; }
    .controls{ display:flex; justify-content:space-between; align-items:center; gap:12px; margin: 8px 0 16px; }
    .controls .left{ display:flex; gap:10px; align-items:center; }
    .pill{ background:var(--panel); padding:8px 12px; border-radius:12px; border:1px solid color-mix(in oklab, var(--panel), #000 35%); }
    select{ background:var(--panel); color:var(--fg); border:1px solid color-mix(in oklab, var(--panel), #000 35%); border-radius:10px; padding:8px 12px; }
    .range{ color:var(--muted); font-variant-numeric:tabular-nums; }

    .grid{ display:grid; gap:16px; }
    .card{
      display:grid; grid-template-columns: minmax(260px, 420px) 1fr; gap:16px; align-items:start;
      background: var(--panel); border-radius:16px; padding:14px; border:1px solid color-mix(in oklab, var(--panel), #000 35%);
      box-shadow: 0 10px 30px -20px #0008;
    }
    .card img{ width:100%; height:260px; object-fit:cover; border-radius:12px; background: #1a1f3a; }
    .card h3{ margin:0 0 6px; font-size: clamp(18px, 1.8vw, 22px); }
    .year{ font-weight:700; letter-spacing:.5px; color:var(--accent); }
    .desc{ color:var(--muted); margin-top:6px; }

    @media (max-width: 860px){
      .card{ grid-template-columns: 1fr; }
      .card img{ height: 220px; }
      .controls{ flex-direction:column; align-items:stretch; }
      .controls .left{ justify-content:space-between; }
    }
  </style>
  <link rel="stylesheet" href="style.css">
</head>
<body class="theme-dark">
  <header>
    <div class="wrap">
      <h1>Uchronie des véhicules
        <span class="sub">• prototype (toutes époques, 5 véhicules par page)</span>
      </h1>
      <div class="bar">
        <div class="eras" id="eraBar" aria-label="Choisir l'époque" role="tablist"></div>
        <div class="themes" aria-label="Thèmes">
          <button data-theme="light" title="Thème clair">Clair</button>
          <button data-theme="dark" title="Thème sombre" aria-current="true">Sombre</button>
          <button data-theme="night" title="Thème nuit">Nuit</button>
        </div>
      </div>
    </div>
  </header>

  <section class="chronodius-hero" id="hero">
  <div class="wrap hero-wrap">
    <h2 class="hero-title">CHRONODIUS</h2>
    <p class="hero-sub">Voyageons autour de l’année 2025</p>

    <a class="hero-cta" href="#cards" aria-label="Aller à la galerie">
      Découvrir
    </a>

    <div class="hero-sketches">
      <!-- Vue 3/4 avant (en haut sur desktop ; en premier sur mobile) -->
      <figure class="hero-sheet">
        <img src="car/chronodius-sketch.png"
             alt="Croquis 3/4 avant d’une supercar futuriste, bleu électrique métallisé, accents argent, pneus esquissés, hachures">
      </figure>

      <!-- Vue de face (en dessous sur desktop et mobile) -->
      <figure class="hero-sheet">
        <img src="car/chronodius-front.png"
             alt="Croquis face avant, phares horizontaux futuristes et calandre de véhicule électrique">
      </figure>
    </div>
  </div>
</section>


  <main class="wrap">
    <div class="controls">
      <div class="left">
        <span class="pill">Époque : <strong id="eraLabel">1925</strong></span>
        <span class="range" id="rangeLabel">(1925–1929)</span>
      </div>
      <label class="pill" for="pageSelect">Page 
        <select id="pageSelect" aria-label="Sélecteur de page"></select>
      </label>
    </div>

    <section class="grid" id="cards" aria-live="polite"></section>
  </main>

  <script>
    // ---------- Config ----------
    const ERAS = [1925, 1950, 1975, 2000, 2025, 2050, 2075, 2100, 2125];
    const ERA_SPAN_YEARS = 25;    // chaque époque couvre 25 ans (ex. 1925–1949)
    const PAGE_SIZE = 5;          // 5 véhicules par page

    // Années pour lesquelles tu as déjà de vraies images dans /img (PNG)
    const AVAILABLE_IMG_YEARS = new Set([
      1925, 1926,
      1930, 1931, 1932, 1934, 1935, 1936, 1937,
      1940, 1941, 1942, 1943, 1944, 1945, 1946, 1947, 1948, 1949,
      1950, 1951, 1952, 1953, 1954, 1955, 1956, 1957, 1958, 1959,
      1960, 1961, 1962, 1963, 1964, 1965, 1966, 1967,
      1970,
      1980, 1981, 1982, 1983,
      1990, 1991, 1992, 1993
    ]);

    // ---------- Éléments ----------
    const eraBar = document.getElementById('eraBar');
    const eraLabel = document.getElementById('eraLabel');
    const rangeLabel = document.getElementById('rangeLabel');
    const pageSelect = document.getElementById('pageSelect');
    const cards = document.getElementById('cards');

    // ---------- Thèmes ----------
    const root = document.body;
    const themeButtons = document.querySelectorAll('[data-theme]');
    const THEME_KEY = 'uchronie_theme';
    function applyTheme(name){
      root.classList.remove('theme-light','theme-dark','theme-night');
      root.classList.add(`theme-${name}`);
      themeButtons.forEach(b=>b.setAttribute('aria-current', b.dataset.theme===name ? 'true' : 'false'));
      localStorage.setItem(THEME_KEY, name);
    }
    // init theme
    applyTheme(localStorage.getItem(THEME_KEY) || 'dark');
    themeButtons.forEach(btn=>btn.addEventListener('click',()=>applyTheme(btn.dataset.theme)));

    // ---------- Utilitaires images ----------
    const PLACEHOLDER = (year)=>`https://via.placeholder.com/800x520?text=${encodeURIComponent('Véhicule '+year)}`;
    function getVehicleImage(year){
      return AVAILABLE_IMG_YEARS.has(year) ? `img/${year}.png` : PLACEHOLDER(year);
    }

    // ---------- Fabrique de données générique ----------
    function makeVehiclesForEra(startYear){
      const out = [];
      for(let y=startYear; y<startYear+ERA_SPAN_YEARS; y++){
        const milestone = (y % 5 === 0); // années .0 ou .5
        const title = milestone ? `Modèle phare ${y}` : `Transition ${y}`;
        const blurb = milestone
          ? `Véhicule "phare" de l'année ${y}. Conçu pour franchir désert et plan d'eau sans arrêt. Mécanique simplifiée, plaques amphibies déployables, refroidissement par air.`
          : `Version de transition ${y}, héritant de ${y-1} et préfigurant ${y+1}. Ailerons sur charnières, admission protégée, réglage de flotteurs évolutif.`;
        out.push({ id:`car-${y}`, year:y, title, img:getVehicleImage(y), desc:blurb });
      }
      return out;
    }

    // Génère les données pour toutes les époques
    const DATA = Object.fromEntries(ERAS.map(era => [era, makeVehiclesForEra(era)]));

    // ---------- UI : barre d'époques ----------
    function buildEraBar(currentEra){
      eraBar.innerHTML = '';
      ERAS.forEach(era => {
        const b = document.createElement('button');
        b.textContent = era;
        b.role = 'tab';
        b.setAttribute('aria-current', era===currentEra ? 'true' : 'false');
        b.addEventListener('click', ()=> navigate(era, 1));
        eraBar.appendChild(b);
      });
    }

    // ---------- Rendu de page ----------
    function render(era, page){
      const vehicles = DATA[era];
      const totalPages = Math.ceil(vehicles.length / PAGE_SIZE);

      // labels
      eraLabel.textContent = era;
      const rangeStart = era;
      const rangeEnd = era + ERA_SPAN_YEARS - 1;
      const sliceStartYear = era + (page-1)*PAGE_SIZE;
      const sliceEndYear = Math.min(rangeStart + page*PAGE_SIZE - 1, rangeEnd);
      rangeLabel.textContent = `(${sliceStartYear}\u2013${sliceEndYear})`;

      // page select
      pageSelect.innerHTML = '';
      for(let p=1; p<=totalPages; p++){
        const opt = document.createElement('option');
        opt.value = p; opt.textContent = `Page ${p}`;
        if(p===page) opt.selected = true;
        pageSelect.appendChild(opt);
      }

      // cards
      const start = (page-1)*PAGE_SIZE;
      const end = start + PAGE_SIZE;
      const pageItems = vehicles.slice(start, end);

      cards.innerHTML = '';
      pageItems.forEach(v => {
        const art = document.createElement('article');
        art.className = 'card';
        const img = document.createElement('img');
        img.setAttribute('alt', `Véhicule de ${v.year}`);
        img.setAttribute('loading', 'lazy');
        img.setAttribute('decoding', 'async');
        img.setAttribute('width', '800');
        img.setAttribute('height', '520');
        img.src = v.img;
        img.onerror = () => { img.onerror = null; img.src = PLACEHOLDER(v.year); };

        const box = document.createElement('div');
        box.innerHTML = `
          <h3><span class="year">${v.year}</span> · ${v.title}</h3>
          <p class="desc">${v.desc}</p>
        `;
        art.append(img, box);
        cards.appendChild(art);
      });
    }

    // ---------- Navigation (hash simple) ----------
    function navigate(era, page){
      location.hash = `#era=${era}&page=${page}`;
    }
    function parseHash(){
      const m = location.hash.match(/era=(\d+).*page=(\d+)/);
      const era = m ? parseInt(m[1],10) : 1925;
      const page = m ? parseInt(m[2],10) : 1;
      return {era, page};
    }
    window.addEventListener('hashchange', ()=>{
      const {era, page} = parseHash();
      buildEraBar(era);
      render(era, page);
    });

    // ---------- Init ----------
    (function init(){
      if(!location.hash) navigate(1925, 1);
      const {era, page} = parseHash();
      buildEraBar(era);
      render(era, page);
      pageSelect.addEventListener('change', e => navigate(parseHash().era, parseInt(e.target.value,10)));
    })();
  </script>
</body>
</html>
